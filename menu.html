function convertDriveLink(link) {
    if (!link || link.trim() === "") return "https://via.placeholder.com/100"; // Заглушка если ссылки нет
    if (link.includes("drive.google.com/file/d/")) {
        let fileId = link.split("/d/")[1].split("/view")[0];
        return `https://drive.google.com/uc?export=view&id=${fileId}`;
    }
    return link.trim(); // Если ссылка уже правильная
}

// Загружаем меню из Google Sheets
function loadMenu() {
    fetch(sheetUrl)
        .then(response => response.text())
        .then(data => {
            const rows = data.split("\n").map(row => row.split(","));
            let menuHTML = "";

            rows.forEach((item, index) => {
                if (index === 0) return; // Пропускаем заголовки

                let name = item[1] ? item[1].trim() : "Без названия"; // Название (B)
                let size = item[2] ? item[2].trim() : ""; // Размер (C)
                let description = item[3] ? item[3].trim() : "Нет описания"; // Описание (D)
                let price = item[4] ? parseFloat(item[4].trim()) : 0; // Цена (E) (Используем parseFloat!)
                let imageUrl = item[5] ? convertDriveLink(item[5].trim()) : "https://via.placeholder.com/100"; // Фото (F)

                menuHTML += `
                    <div class="menu-item">
                        <img src="${imageUrl}" alt="${name}" style="width:100px;">
                        <h3>${name} ${size} - ${isNaN(price) ? "Цена не указана" : price + "₽"}</h3>
                        <p>${description}</p>
                        <button onclick="addToCart('${name}', ${price})">➕ Добавить</button>
                    </div>`;
            });

            document.getElementById("menu").innerHTML = menuHTML;
        })
        .catch(error => console.error("Ошибка загрузки меню:", error));
}

